<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>정형 데이터 마이닝 - 타이타닉 - My New Hugo Site</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="정형 데이터 마이닝 - 타이타닉" />
<meta property="og:description" content="정형 데이터 마이닝 - 타이타닉 library(dplyr) setwd(&#34;C:/ADP/data&#34;) # 데이터 불러오기 titanic &lt;- read.csv(&#34;titanic.csv&#34;) summary(titanic) # cabin, embarked의 &#34;&#34; -&gt; NA 바꾸기 # embarked # factor 형태로 변환 titanic$embarked &lt;- as.factor(titanic$embarked) levels(titanic$embarked) # [1] &#34;&#34; &#34;C&#34; &#34;Q&#34; &#34;S&#34; # &#34;&#34; -&gt; NA 변환 levels(titanic$embarked)[1] &lt;- NA table(titanic$embarked,useNA = &#34;always&#34;) # C Q S &lt;NA&gt;  # 270 123 914 2  # cabin titanic$cabin &lt;- ifelse(titanic$cabin==&#34;&#34;,NA,titanic$cabin) table(titanic$cabin,useNA = &#34;always&#34;) summary(titanic) # pclass survived name sex age  # Min." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://sjh4773.github.io/post/titanic/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-05-30T19:53:02&#43;09:00" />
<meta property="article:modified_time" content="2021-05-30T19:53:02&#43;09:00" />


		<meta itemprop="name" content="정형 데이터 마이닝 - 타이타닉">
<meta itemprop="description" content="정형 데이터 마이닝 - 타이타닉 library(dplyr) setwd(&#34;C:/ADP/data&#34;) # 데이터 불러오기 titanic &lt;- read.csv(&#34;titanic.csv&#34;) summary(titanic) # cabin, embarked의 &#34;&#34; -&gt; NA 바꾸기 # embarked # factor 형태로 변환 titanic$embarked &lt;- as.factor(titanic$embarked) levels(titanic$embarked) # [1] &#34;&#34; &#34;C&#34; &#34;Q&#34; &#34;S&#34; # &#34;&#34; -&gt; NA 변환 levels(titanic$embarked)[1] &lt;- NA table(titanic$embarked,useNA = &#34;always&#34;) # C Q S &lt;NA&gt;  # 270 123 914 2  # cabin titanic$cabin &lt;- ifelse(titanic$cabin==&#34;&#34;,NA,titanic$cabin) table(titanic$cabin,useNA = &#34;always&#34;) summary(titanic) # pclass survived name sex age  # Min."><meta itemprop="datePublished" content="2021-05-30T19:53:02&#43;09:00" />
<meta itemprop="dateModified" content="2021-05-30T19:53:02&#43;09:00" />
<meta itemprop="wordCount" content="1314">
<meta itemprop="keywords" content="ADP 모의고사 R 실습," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="정형 데이터 마이닝 - 타이타닉"/>
<meta name="twitter:description" content="정형 데이터 마이닝 - 타이타닉 library(dplyr) setwd(&#34;C:/ADP/data&#34;) # 데이터 불러오기 titanic &lt;- read.csv(&#34;titanic.csv&#34;) summary(titanic) # cabin, embarked의 &#34;&#34; -&gt; NA 바꾸기 # embarked # factor 형태로 변환 titanic$embarked &lt;- as.factor(titanic$embarked) levels(titanic$embarked) # [1] &#34;&#34; &#34;C&#34; &#34;Q&#34; &#34;S&#34; # &#34;&#34; -&gt; NA 변환 levels(titanic$embarked)[1] &lt;- NA table(titanic$embarked,useNA = &#34;always&#34;) # C Q S &lt;NA&gt;  # 270 123 914 2  # cabin titanic$cabin &lt;- ifelse(titanic$cabin==&#34;&#34;,NA,titanic$cabin) table(titanic$cabin,useNA = &#34;always&#34;) summary(titanic) # pclass survived name sex age  # Min."/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="My New Hugo Site" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">My New Hugo Site</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">정형 데이터 마이닝 - 타이타닉</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">JiHun</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2021-05-30T19:53:02&#43;09:00">2021-05-30</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/adp-%EB%AA%A8%EC%9D%98%EA%B3%A0%EC%82%AC-r-%EC%8B%A4%EC%8A%B5/" rel="category">ADP 모의고사 R 실습</a>
	</span>
</div></div>
		</header><div class="content post__content clearfix">
			<h1 id="정형-데이터-마이닝---타이타닉">정형 데이터 마이닝 - 타이타닉</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#a6e22e">library</span>(dplyr)



<span style="color:#a6e22e">setwd</span>(<span style="color:#e6db74">&#34;C:/ADP/data&#34;</span>)

<span style="color:#75715e"># 데이터 불러오기</span>

titanic <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;titanic.csv&#34;</span>)
<span style="color:#a6e22e">summary</span>(titanic)

<span style="color:#75715e"># cabin, embarked의 &#34;&#34; -&gt; NA 바꾸기</span>

<span style="color:#75715e"># embarked</span>

<span style="color:#75715e"># factor 형태로 변환</span>
titanic<span style="color:#f92672">$</span>embarked <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(titanic<span style="color:#f92672">$</span>embarked)

<span style="color:#a6e22e">levels</span>(titanic<span style="color:#f92672">$</span>embarked)
<span style="color:#75715e"># [1] &#34;&#34;  &#34;C&#34; &#34;Q&#34; &#34;S&#34;</span>

<span style="color:#75715e"># &#34;&#34; -&gt; NA 변환</span>
<span style="color:#a6e22e">levels</span>(titanic<span style="color:#f92672">$</span>embarked)[1] <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">NA</span>

<span style="color:#a6e22e">table</span>(titanic<span style="color:#f92672">$</span>embarked,useNA <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;always&#34;</span>)
<span style="color:#75715e"># C    Q    S &lt;NA&gt; </span>
<span style="color:#75715e">#   270  123  914    2 </span>

<span style="color:#75715e"># cabin</span>

titanic<span style="color:#f92672">$</span>cabin <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(titanic<span style="color:#f92672">$</span>cabin<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#66d9ef">NA</span>,titanic<span style="color:#f92672">$</span>cabin)
<span style="color:#a6e22e">table</span>(titanic<span style="color:#f92672">$</span>cabin,useNA <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;always&#34;</span>)


<span style="color:#a6e22e">summary</span>(titanic)


<span style="color:#75715e"># pclass         survived         name               sex                 age       </span>
<span style="color:#75715e"># Min.   :1.000   Min.   :0.000   Length:1309        Length:1309        Min.   : 0.17  </span>
<span style="color:#75715e"># 1st Qu.:2.000   1st Qu.:0.000   Class :character   Class :character   1st Qu.:21.00  </span>
<span style="color:#75715e"># Median :3.000   Median :0.000   Mode  :character   Mode  :character   Median :28.00  </span>
<span style="color:#75715e"># Mean   :2.295   Mean   :0.382                                         Mean   :29.88  </span>
<span style="color:#75715e"># 3rd Qu.:3.000   3rd Qu.:1.000                                         3rd Qu.:39.00  </span>
<span style="color:#75715e"># Max.   :3.000   Max.   :1.000                                         Max.   :80.00  </span>
<span style="color:#75715e"># NA&#39;s   :263    </span>
<span style="color:#75715e">#      sibsp            parch          ticket               fare        </span>
<span style="color:#75715e">#  Min.   :0.0000   Min.   :0.000   Length:1309        Min.   :  0.000  </span>
<span style="color:#75715e">#  1st Qu.:0.0000   1st Qu.:0.000   Class :character   1st Qu.:  7.896  </span>
<span style="color:#75715e">#  Median :0.0000   Median :0.000   Mode  :character   Median : 14.454  </span>
<span style="color:#75715e">#  Mean   :0.4989   Mean   :0.385                      Mean   : 33.295  </span>
<span style="color:#75715e">#  3rd Qu.:1.0000   3rd Qu.:0.000                      3rd Qu.: 31.275  </span>
<span style="color:#75715e">#  Max.   :8.0000   Max.   :9.000                      Max.   :512.329  </span>
<span style="color:#75715e">#                                                      NA&#39;s   :1        </span>
<span style="color:#75715e"># cabin           embarked  </span>
<span style="color:#75715e"># Length:1309        C   :270  </span>
<span style="color:#75715e"># Class :character   Q   :123  </span>
<span style="color:#75715e"># Mode  :character   S   :914  </span>
<span style="color:#75715e">#                    NA&#39;s:  2</span>


<span style="color:#75715e"># 변수의 데이터 타입 확인 뒤, 타입 변환</span>

<span style="color:#a6e22e">str</span>(titanic)

<span style="color:#75715e"># &#39;data.frame&#39;:	1309 obs. of  11 variables:</span>
<span style="color:#75715e">#   $ pclass  : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span style="color:#75715e"># $ survived: int  1 1 0 0 0 1 1 0 1 0 ...</span>
<span style="color:#75715e"># $ name    : chr  &#34;Allen, Miss. Elisabeth Walton&#34; &#34;Allison, Master. Hudson Trevor&#34; &#34;Allison, Miss. Helen Loraine&#34; &#34;Allison, Mr. Hudson Joshua Creighton&#34; ...</span>
<span style="color:#75715e"># $ sex     : chr  &#34;female&#34; &#34;male&#34; &#34;female&#34; &#34;male&#34; ...</span>
<span style="color:#75715e"># $ age     : num  29 0.92 2 30 25 48 63 39 53 71 ...</span>
<span style="color:#75715e"># $ sibsp   : int  0 1 1 1 1 0 1 0 2 0 ...</span>
<span style="color:#75715e"># $ parch   : int  0 2 2 2 2 0 0 0 0 0 ...</span>
<span style="color:#75715e"># $ ticket  : chr  &#34;24160&#34; &#34;113781&#34; &#34;113781&#34; &#34;113781&#34; ...</span>
<span style="color:#75715e"># $ fare    : num  211 152 152 152 152 ...</span>
<span style="color:#75715e"># $ cabin   : chr  &#34;B5&#34; &#34;C22 C26&#34; &#34;C22 C26&#34; &#34;C22 C26&#34; ...</span>
<span style="color:#75715e"># $ embarked: Factor w/ 3 levels &#34;C&#34;,&#34;Q&#34;,&#34;S&#34;: 3 3 3 3 3 3 3 3 3 1 ...</span>

<span style="color:#75715e"># 변수의 데이터 타입 변환</span>
titanic<span style="color:#f92672">$</span>pclass <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(titanic<span style="color:#f92672">$</span>pclass)
titanic<span style="color:#f92672">$</span>survived <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(titanic<span style="color:#f92672">$</span>survived,levels<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>),labels<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dead&#34;</span>,<span style="color:#e6db74">&#34;survived&#34;</span>))

<span style="color:#75715e"># 변환된 변수 확인</span>
<span style="color:#a6e22e">str</span>(titanic)

<span style="color:#75715e"># 결측치 대치</span>
<span style="color:#a6e22e">sum</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">complete.cases</span>(titanic))

<span style="color:#75715e"># 모든 컬럼에 있는 NA 개수를 구해준다.</span>
<span style="color:#a6e22e">colSums</span>(<span style="color:#a6e22e">is.na</span>(titanic))

<span style="color:#75715e"># pclass survived     name      sex      age    sibsp    parch   ticket     fare </span>
<span style="color:#75715e"># 0        0        0        0      263        0        0        0        1 </span>
<span style="color:#75715e"># cabin embarked </span>
<span style="color:#75715e"># 1014        2 </span>


<span style="color:#75715e"># 수치형 변수 결측치 중앙값 대체</span>
titanic<span style="color:#f92672">$</span>age<span style="color:#a6e22e">[is.na</span>(titanic<span style="color:#f92672">$</span>age)] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">median</span>(titanic<span style="color:#f92672">$</span>age, na.rm<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)

<span style="color:#a6e22e">sum</span>(<span style="color:#a6e22e">is.na</span>(titanic<span style="color:#f92672">$</span>age))

titanic<span style="color:#f92672">$</span>fare<span style="color:#a6e22e">[is.na</span>(titanic<span style="color:#f92672">$</span>fare)] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">median</span>(titanic<span style="color:#f92672">$</span>fare, na.rm <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)

<span style="color:#a6e22e">sum</span>(<span style="color:#a6e22e">is.na</span>(titanic<span style="color:#f92672">$</span>fare))


<span style="color:#75715e"># 변수형 변수 최빈값 대체</span>

<span style="color:#75715e"># 최빈값 함수</span>

mode <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(x){
  <span style="color:#a6e22e">return</span>(<span style="color:#a6e22e">names</span>(<span style="color:#a6e22e">sort</span>(<span style="color:#a6e22e">table</span>(x), decreasing <span style="color:#f92672">=</span> T)[1] ) <span style="color:#f92672">%&gt;%</span> as.character)
}

<span style="color:#a6e22e">mode</span>(titanic<span style="color:#f92672">$</span>embarked)

titanic<span style="color:#f92672">$</span>embarked<span style="color:#a6e22e">[is.na</span>(titanic<span style="color:#f92672">$</span>embarked)] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">mode</span>(titanic<span style="color:#f92672">$</span>embarked)

<span style="color:#a6e22e">sum</span>(<span style="color:#a6e22e">is.na</span>(titanic<span style="color:#f92672">$</span>embarked))

titanic<span style="color:#f92672">$</span>cabin<span style="color:#a6e22e">[is.na</span>(titanic<span style="color:#f92672">$</span>cabin)] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">mode</span>(titanic<span style="color:#f92672">$</span>cabin)

<span style="color:#a6e22e">sum</span>(<span style="color:#a6e22e">is.na</span>(titanic<span style="color:#f92672">$</span>cabin))

<span style="color:#a6e22e">table</span>(titanic<span style="color:#f92672">$</span>cabin)


<span style="color:#75715e"># age의 범주를 나눔</span>

titanic <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">within</span>(titanic,
                  {
                    age_band <span style="color:#f92672">=</span> <span style="color:#a6e22e">integer</span>(<span style="color:#ae81ff">0</span>)
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">10</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">20</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">30</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">40</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">40</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">50</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">50</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">60</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">60</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">70</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">70</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">80</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">7</span>
                    age_band[age<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">80</span> <span style="color:#f92672">&amp;</span> age<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">90</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>
                  })

titanic<span style="color:#f92672">$</span>age_band <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(titanic<span style="color:#f92672">$</span>age_band, levels<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">8</span>),
                           labels<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;10세 미만&#34;</span>,<span style="color:#e6db74">&#34;10대&#34;</span>,<span style="color:#e6db74">&#34;20대&#34;</span>,<span style="color:#e6db74">&#34;30대&#34;</span>,<span style="color:#e6db74">&#34;40대&#34;</span>,<span style="color:#e6db74">&#34;50대&#34;</span>,<span style="color:#e6db74">&#34;60대&#34;</span>,<span style="color:#e6db74">&#34;70대&#34;</span>,<span style="color:#e6db74">&#34;80대&#34;</span>))

<span style="color:#a6e22e">str</span>(titanic)


<span style="color:#75715e"># 데이터 분할</span>
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">12345</span>)
idx <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sample</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(titanic),size<span style="color:#f92672">=</span><span style="color:#a6e22e">nrow</span>(titanic)<span style="color:#f92672">*</span><span style="color:#ae81ff">0.7</span>,replace<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>)
train_df <span style="color:#f92672">&lt;-</span>titanic[idx,]
test_df<span style="color:#f92672">&lt;-</span>titanic[<span style="color:#f92672">-</span>idx,]
<span style="color:#a6e22e">nrow</span>(train_df)
<span style="color:#a6e22e">nrow</span>(test_df)


<span style="color:#75715e"># 모델링 하기 전 분석에 사용할 변수만 추출</span>
train <span style="color:#f92672">&lt;-</span> train_df[,<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;pclass&#34;</span>,<span style="color:#e6db74">&#34;survived&#34;</span>,<span style="color:#e6db74">&#34;sex&#34;</span>,<span style="color:#e6db74">&#34;sibsp&#34;</span>,<span style="color:#e6db74">&#34;parch&#34;</span>,<span style="color:#e6db74">&#34;fare&#34;</span>,<span style="color:#e6db74">&#34;embarked&#34;</span>)]
test <span style="color:#f92672">&lt;-</span> test_df[,<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;pclass&#34;</span>,<span style="color:#e6db74">&#34;survived&#34;</span>,<span style="color:#e6db74">&#34;sex&#34;</span>,<span style="color:#e6db74">&#34;sibsp&#34;</span>,<span style="color:#e6db74">&#34;parch&#34;</span>,<span style="color:#e6db74">&#34;fare&#34;</span>,<span style="color:#e6db74">&#34;embarked&#34;</span>)]
<span style="color:#a6e22e">str</span>(train)

<span style="color:#75715e"># 모델링 의사결정나무(깊이를 최대 5개까지, 최소 관측치는 15개 이상)</span>
<span style="color:#a6e22e">install.packages</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;rpart&#34;</span>,<span style="color:#e6db74">&#34;rpart.plot&#34;</span>))
<span style="color:#a6e22e">library</span>(rpart)
<span style="color:#a6e22e">library</span>(rpart.plot)
dt.model <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rpart</span>(survived <span style="color:#f92672">~</span>., method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class&#39;</span>, data<span style="color:#f92672">=</span>train, control<span style="color:#f92672">=</span><span style="color:#a6e22e">rpart.control</span>(maxdepth<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, minsplit<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>))
dt.model

<span style="color:#75715e"># n= 916 </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># node), split, n, loss, yval, (yprob)</span>
<span style="color:#75715e"># * denotes terminal node</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># 1) root 916 350 dead (0.61790393 0.38209607)  </span>
<span style="color:#75715e"># 2) sex=male 582 104 dead (0.82130584 0.17869416) *</span>
<span style="color:#75715e">#   3) sex=female 334  88 survived (0.26347305 0.73652695)  </span>
<span style="color:#75715e">#   6) pclass=3 156  76 survived (0.48717949 0.51282051)  </span>
<span style="color:#75715e">#   12) fare&gt;=23.35 22   3 dead (0.86363636 0.13636364) *</span>
<span style="color:#75715e">#   13) fare&lt; 23.35 134  57 survived (0.42537313 0.57462687) *</span>
<span style="color:#75715e">#   7) pclass=1,2 178  12 survived (0.06741573 0.93258427) *</span>

<span style="color:#a6e22e">prp</span>(dt.model,type<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>,extra<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</code></pre></div><p><img src="/image/titanic1.PNG" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">

pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(dt.model,test[,<span style="color:#ae81ff">-2</span>],type<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;prob&#39;</span>)
<span style="color:#a6e22e">write.csv</span>(pred,<span style="color:#e6db74">&#34;decisionTree predict.csv&#34;</span>)

<span style="color:#75715e"># 모델링 랜덤 포레스트</span>
<span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;randomForest&#34;</span>)
<span style="color:#a6e22e">library</span>(randomForest)

rf.model <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">randomForest</span>(formula <span style="color:#f92672">=</span> survived<span style="color:#f92672">~</span>., data<span style="color:#f92672">=</span>train)
<span style="color:#a6e22e">print</span>(rf.model)

<span style="color:#75715e"># Call:</span>
<span style="color:#75715e">#   randomForest(formula = survived ~ ., data = train) </span>
<span style="color:#75715e"># Type of random forest: classification</span>
<span style="color:#75715e"># Number of trees: 500</span>
<span style="color:#75715e"># No. of variables tried at each split: 2</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># OOB estimate of  error rate: 20.52%</span>
<span style="color:#75715e"># Confusion matrix:</span>
<span style="color:#75715e">#   dead survived class.error</span>
<span style="color:#75715e"># dead      511       55  0.09717314</span>
<span style="color:#75715e"># survived  133      217  0.38000000</span>

pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(rf.model,test[,<span style="color:#ae81ff">-2</span>],type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;prob&#34;</span>)
<span style="color:#a6e22e">write.csv</span>(pred,<span style="color:#e6db74">&#34;randomForest predict.csv&#34;</span>)

<span style="color:#75715e"># 모델링 로지스틱 회귀분석</span>
lg.model <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">step</span>(<span style="color:#a6e22e">glm</span>(survived<span style="color:#f92672">~</span><span style="color:#ae81ff">1</span>, data<span style="color:#f92672">=</span>train, family<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;binomial&#34;</span>),direction<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;both&#34;</span>,
                 scope<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(lower<span style="color:#f92672">=~</span><span style="color:#ae81ff">1</span>, upper<span style="color:#f92672">=~</span>pclass<span style="color:#f92672">+</span>sex<span style="color:#f92672">+</span>sibsp<span style="color:#f92672">+</span>parch<span style="color:#f92672">+</span>fare<span style="color:#f92672">+</span>embarked))

<span style="color:#a6e22e">summary</span>(lg.model)


<span style="color:#75715e"># Call:</span>
<span style="color:#75715e">#   glm(formula = survived ~ sex + pclass + embarked + sibsp, family = &#34;binomial&#34;, </span>
<span style="color:#75715e">#       data = train)</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Deviance Residuals: </span>
<span style="color:#75715e">#   Min       1Q   Median       3Q      Max  </span>
<span style="color:#75715e"># -2.2973  -0.6783  -0.4402   0.6838   2.3801  </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Coefficients:</span>
<span style="color:#75715e">#   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span style="color:#75715e"># (Intercept)  2.56479    0.26026   9.855  &lt; 2e-16 ***</span>
<span style="color:#75715e">#   sexmale     -2.68646    0.18501 -14.520  &lt; 2e-16 ***</span>
<span style="color:#75715e">#   pclass2     -0.61090    0.25349  -2.410  0.01595 *  </span>
<span style="color:#75715e">#   pclass3     -1.54394    0.21864  -7.062 1.64e-12 ***</span>
<span style="color:#75715e">#   embarkedQ   -0.31418    0.34788  -0.903  0.36646    </span>
<span style="color:#75715e"># embarkedS   -0.61980    0.22001  -2.817  0.00485 ** </span>
<span style="color:#75715e">#   sibsp       -0.16208    0.09883  -1.640  0.10100    </span>
<span style="color:#75715e"># ---</span>
<span style="color:#75715e">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># (Dispersion parameter for binomial family taken to be 1)</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Null deviance: 1218.43  on 915  degrees of freedom</span>
<span style="color:#75715e"># Residual deviance:  846.59  on 909  degrees of freedom</span>
<span style="color:#75715e"># AIC: 860.59</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Number of Fisher Scoring iterations: 4</span>

pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(lg.model, test[,<span style="color:#ae81ff">-2</span>], type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;response&#34;</span>)
pred_df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.data.frame</span>(pred)
pred_df<span style="color:#f92672">$</span>survived <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(pred_df<span style="color:#f92672">$</span>pred<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">0.5</span>,pred_df<span style="color:#f92672">$</span>survived<span style="color:#f92672">&lt;-</span><span style="color:#e6db74">&#34;dead&#34;</span>,pred_df<span style="color:#f92672">$</span>survived<span style="color:#f92672">&lt;-</span><span style="color:#e6db74">&#34;survived&#34;</span>)
<span style="color:#a6e22e">write.csv</span>(pred_df,<span style="color:#e6db74">&#34;logistic regression predict.csv&#34;</span>)

<span style="color:#75715e"># 성과분석 - 의사결정나무</span>
<span style="color:#a6e22e">library</span>(caret)
<span style="color:#a6e22e">library</span>(ROCR)
pred.dt<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">predict</span>(dt.model,test[,<span style="color:#ae81ff">-2</span>],type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;class&#34;</span>)
<span style="color:#a6e22e">confusionMatrix</span>(data<span style="color:#f92672">=</span>pred.dt, reference<span style="color:#f92672">=</span>test[,<span style="color:#ae81ff">2</span>],positive<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;survived&#34;</span>)

<span style="color:#75715e"># Confusion Matrix and Statistics</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Reference</span>
<span style="color:#75715e"># Prediction dead survived</span>
<span style="color:#75715e"># dead      215       57</span>
<span style="color:#75715e"># survived   28       93</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Accuracy : 0.7837          </span>
<span style="color:#75715e"># 95% CI : (0.7397, 0.8234)</span>
<span style="color:#75715e"># No Information Rate : 0.6183          </span>
<span style="color:#75715e"># P-Value [Acc &gt; NIR] : 1.589e-12       </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Kappa : 0.5242          </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Mcnemar&#39;s Test P-Value : 0.002389        </span>
<span style="color:#75715e">#                                           </span>
<span style="color:#75715e">#             Sensitivity : 0.6200          </span>
<span style="color:#75715e">#             Specificity : 0.8848          </span>
<span style="color:#75715e">#          Pos Pred Value : 0.7686          </span>
<span style="color:#75715e">#          Neg Pred Value : 0.7904          </span>
<span style="color:#75715e">#              Prevalence : 0.3817          </span>
<span style="color:#75715e">#          Detection Rate : 0.2366          </span>
<span style="color:#75715e">#    Detection Prevalence : 0.3079          </span>
<span style="color:#75715e">#       Balanced Accuracy : 0.7524          </span>
<span style="color:#75715e">#                                           </span>
<span style="color:#75715e">#        &#39;Positive&#39; Class : survived       </span>
</code></pre></div><p><img src="/image/titanic2.PNG" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">

pred.dt.roc <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">prediction</span>(<span style="color:#a6e22e">as.numeric</span>(pred.dt),<span style="color:#a6e22e">as.numeric</span>(test[,<span style="color:#ae81ff">2</span>]))
<span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">performance</span>(pred.dt.roc,<span style="color:#e6db74">&#34;tpr&#34;</span>,<span style="color:#e6db74">&#34;fpr&#34;</span>))
<span style="color:#a6e22e">abline</span>(a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,lty<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>)
<span style="color:#a6e22e">performance</span>(pred.dt.roc,<span style="color:#e6db74">&#34;auc&#34;</span>)<span style="color:#f92672">@</span>y.values

<span style="color:#75715e"># [[1]]</span>
<span style="color:#75715e"># [1] 0.7523868</span>


<span style="color:#75715e"># 성과분석 - 랜덤포레스트</span>
pred.rf <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(rf.model, test[,<span style="color:#ae81ff">-2</span>], type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;class&#34;</span>)
<span style="color:#a6e22e">confusionMatrix</span>(data<span style="color:#f92672">=</span>pred.rf, reference<span style="color:#f92672">=</span>test[,<span style="color:#ae81ff">2</span>],positive<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;survived&#34;</span>)

<span style="color:#75715e"># Confusion Matrix and Statistics</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Reference</span>
<span style="color:#75715e"># Prediction dead survived</span>
<span style="color:#75715e"># dead      219       62</span>
<span style="color:#75715e"># survived   24       88</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Accuracy : 0.7812         </span>
<span style="color:#75715e"># 95% CI : (0.737, 0.8211)</span>
<span style="color:#75715e"># No Information Rate : 0.6183         </span>
<span style="color:#75715e"># P-Value [Acc &gt; NIR] : 3.555e-12      </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Kappa : 0.5128         </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Mcnemar&#39;s Test P-Value : 6.613e-05      </span>
<span style="color:#75715e">#                                          </span>
<span style="color:#75715e">#             Sensitivity : 0.5867         </span>
<span style="color:#75715e">#             Specificity : 0.9012         </span>
<span style="color:#75715e">#          Pos Pred Value : 0.7857         </span>
<span style="color:#75715e">#          Neg Pred Value : 0.7794         </span>
<span style="color:#75715e">#              Prevalence : 0.3817         </span>
<span style="color:#75715e">#          Detection Rate : 0.2239         </span>
<span style="color:#75715e">#    Detection Prevalence : 0.2850         </span>
<span style="color:#75715e">#       Balanced Accuracy : 0.7440         </span>
<span style="color:#75715e">#                                          </span>
<span style="color:#75715e">#        &#39;Positive&#39; Class : survived</span>

pred.rf.roc <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">prediction</span>(<span style="color:#a6e22e">as.numeric</span>(pred.rf),<span style="color:#a6e22e">as.numeric</span>(test[,<span style="color:#ae81ff">2</span>]))
<span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">performance</span>(pred.rf.roc,<span style="color:#e6db74">&#34;tpr&#34;</span>,<span style="color:#e6db74">&#34;fpr&#34;</span>))
<span style="color:#a6e22e">abline</span>(a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,lty<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>)
</code></pre></div><p><img src="/image/titanic3.PNG" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">

<span style="color:#a6e22e">performance</span>(pred.rf.roc,<span style="color:#e6db74">&#34;auc&#34;</span>)<span style="color:#f92672">@</span>y.values

<span style="color:#75715e"># [[1]]</span>
<span style="color:#75715e"># [1] 0.7439506</span>

<span style="color:#75715e"># 성과분석 - 로지스틱 회귀분석</span>

pred.lg <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(lg.model,test[,<span style="color:#ae81ff">-2</span>],type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;response&#34;</span>)
pred.lg <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.data.frame</span>(pred.lg)
pred.lg<span style="color:#f92672">$</span>survived <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(pred.lg<span style="color:#f92672">$</span>pred<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">0.5</span>,pred.lg<span style="color:#f92672">$</span>survived<span style="color:#f92672">&lt;-</span><span style="color:#e6db74">&#34;dead&#34;</span>,pred.lg<span style="color:#f92672">$</span>survived<span style="color:#f92672">&lt;-</span><span style="color:#e6db74">&#34;survived&#34;</span>)
<span style="color:#a6e22e">confusionMatrix</span>(data<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(pred.lg<span style="color:#f92672">$</span>survived),reference<span style="color:#f92672">=</span>test[,<span style="color:#ae81ff">2</span>],positive<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;survived&#34;</span>)

<span style="color:#75715e"># Confusion Matrix and Statistics</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Reference</span>
<span style="color:#75715e"># Prediction dead survived</span>
<span style="color:#75715e"># dead      211       57</span>
<span style="color:#75715e"># survived   32       93</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Accuracy : 0.7735         </span>
<span style="color:#75715e"># 95% CI : (0.7289, 0.814)</span>
<span style="color:#75715e"># No Information Rate : 0.6183         </span>
<span style="color:#75715e"># P-Value [Acc &gt; NIR] : 3.647e-11      </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Kappa : 0.5044         </span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># Mcnemar&#39;s Test P-Value : 0.01096        </span>
<span style="color:#75715e">#                                          </span>
<span style="color:#75715e">#             Sensitivity : 0.6200         </span>
<span style="color:#75715e">#             Specificity : 0.8683         </span>
<span style="color:#75715e">#          Pos Pred Value : 0.7440         </span>
<span style="color:#75715e">#          Neg Pred Value : 0.7873         </span>
<span style="color:#75715e">#              Prevalence : 0.3817         </span>
<span style="color:#75715e">#          Detection Rate : 0.2366         </span>
<span style="color:#75715e">#    Detection Prevalence : 0.3181         </span>
<span style="color:#75715e">#       Balanced Accuracy : 0.7442         </span>
<span style="color:#75715e">#                                          </span>
<span style="color:#75715e">#        &#39;Positive&#39; Class : survived</span>


pred.lg<span style="color:#f92672">$</span>survived<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">as.factor</span>(pred.lg<span style="color:#f92672">$</span>survived)
pred.lg.roc<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">prediction</span>(<span style="color:#a6e22e">as.numeric</span>(pred.lg<span style="color:#f92672">$</span>survived),<span style="color:#a6e22e">as.numeric</span>(test[,<span style="color:#ae81ff">2</span>]))                                         
<span style="color:#a6e22e">plot</span>(<span style="color:#a6e22e">performance</span>(pred.lg.roc,<span style="color:#e6db74">&#34;tpr&#34;</span>,<span style="color:#e6db74">&#34;fpr&#34;</span>))
<span style="color:#a6e22e">abline</span>(a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,lty<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>)
</code></pre></div><p><img src="/image/titanic4.PNG" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">

<span style="color:#a6e22e">performance</span>(pred.lg.roc,<span style="color:#e6db74">&#34;auc&#34;</span>)<span style="color:#f92672">@</span>y.values


<span style="color:#75715e"># [[1]]</span>
<span style="color:#75715e"># [1] 0.7441564</span>
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/adp-%EB%AA%A8%EC%9D%98%EA%B3%A0%EC%82%AC-r-%EC%8B%A4%EC%8A%B5/" rel="tag">ADP 모의고사 R 실습</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<div class="authorbox__header">
		<span class="authorbox__name">About JiHun</span>
	</div>
	<div class="authorbox__description">
		John Doe&rsquo;s true identity is unknown. Maybe he is a successful blogger or writer. Nobody knows it.
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/post/lstm/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Lstm 이론</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/post/car/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">통계분석 - 실습데이터 Carseats</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 JiHun.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>